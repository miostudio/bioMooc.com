<!Doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>R 教程 | 生物慕课网</title>

<link rel="canonical" href="http://www.biomooc.com/R/R-tutorial.html" />
<meta name="keywords" content="R 绘图教程,R低水平绘图命令">
<meta name="description" content="R 绘图教程,R低水平绘图命令。">
		
	<link rel="shortcut icon" href="/img/favicon.ico" mce_href="/img/favicon.ico" type="image/x-icon" >
	<link rel="stylesheet" href="/wp-content/themes/biomooc/style.css?v=1.141" type="text/css" media="all" />	
	<link rel="stylesheet" href="/static/css/font-awesome.min.css" media="all" />	
<!--
	<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" media="all" />	  
-->
  <!--[if gte IE 9]><!-->
  <script src="/static/js/jquery.min.js"></script>
  <!--<![endif]-->
  <!--[if lt IE 9]>
     <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
     <script src="//cdn.bootcss.com/html5shiv/r29/html5.min.js"></script>
  <![endif]-->
  <link rel="apple-touch-icon" href="/img/mobile-icon.png"/>
  <meta name="apple-mobile-web-app-title" content="生物慕课网">
<style>
.red{color:red}
.orange{color:orange}
.blue{color:blue}
.lime{color:lime}
</style>

<style>
/*本页R代码过长: 最长n px,超过了出现滚动条*/
.notranslate{max-height:400px; overflow-y:scroll;}

h2.tutheader{margin-top:30px!important;}
h3, h4{ border-left:3px solid #E5502A; padding-left:3px; margin-top:20px!important;}
</style>
</head>


<body>
<!-- 头尾自动加载 -->
<script>
$(function(){
	$.get('/part/header-nav.html',function(data,status){
		$('body').prepend(data);//header-nav
	});
	
	$('<div id="footer" class="mar-t50"></div>').appendTo($("body"));
	$("#footer").load("/part/footer.html"); //footer
	
	$.get('/part/right-bottom-btn.html',function(data,status){
		$('#footer').after(data);//右下角按钮
	});

	
			
	//左右菜单
	$.get('./part/menu-left.html',function(data,status){
		$('.main .row').first().prepend(data);//左侧菜单-本文件夹内使用
	});
	
	$.get('/part/menu-right.html',function(data,status){
		$('.main .row').first().append(data);//右侧菜单-全局通用
		//没有事件，还需要绑定事件
		
		
	});
	
	$.getScript("/wp-content/themes/biomooc/assets/js/main.js?v=1.15");//回到顶部js文件
});
</script>


	
	

<!--  内容  -->
<div class="container main">
	<!-- 中间 -->
	<div class="row">
	





<div class="col middle-column">
		
	
	<div class="article">
			<div class="article-heading-ad" style="display: none;">
		
		</div>
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
		<div class="article-body">
		
			<div class="article-intro" id="content">
			
			<h1><span class="color_h1">R统计 </span> 抽样、模拟与拟合</h1>



<h2 class="tutheader">目录</h2>
<p><b>要点</b>: 为了探究真实数据的规律，我们需要抽样、模拟与拟合。[]</p>

<ul>
	<li><a href="#0">统计</a>
		<ul>
			<li><a href="#0_1">R中 var(X) 和 DX = E(X^2) - (E(X))^2 为什么不一样？</a>
		</ul>
	</li>
	<li><a href="#1">抽样 sample</a></li>
	<li><a href="#2">模拟</a></li>
	<li><a href="#3">拟合</a>
		<ul>
			<li><a href="#3_1">LOESS平滑化算法</a>
			<li><a href="#3_2">局部加权回归LOWESS 平滑化</a>
		</ul>
	</li>
	<li><a href="#100">参考资料</a></li>

</ul>




<a name="0"></a>
<h2 class="tutheader">统计</h2>



<a name="0_1"></a>
<h3 class="tutheader">R中 var(X) 和 DX = E(X^2) - (E(X))^2 为什么不一样？</h3>

<div class="code notranslate">
	<div style="white-space: pre-wrap;">x=c(1,2,3,4,5);x
sd(x)**2 #2.5
var(x) #2.5
mean(x**2)-(mean(x))**2 #2
# 为什么不一样呢？

sum((x-mean(x))**2)/length(x) #2 (除以n) 是样本方差 
sum((x-mean(x))**2)/(length(x)-1) #2.5 (除以 n-1) 是总体方差的无偏估计


#########
# python中的numpy默认使用的是样本方差(除以n)
np.var([1,2,3,4,5]) #2.0
# 但是设置减少的自由度为1后，就是总体方差的无偏估计了
np.var([1,2,3,4,5], ddof=1) #2.5
## ddof : int, optional
## "Delta Degrees of Freedom": the divisor used in the calculation is ``N - ddof``, where ``N`` represents the number of elements. By default `ddof` is zero.</div>
</div>









<a name="1"></a>
<h2 class="tutheader">抽样</h2>
<p>很多使用随机的地方在函数内部，不看源代码的话是找不到的。</p>
<pre>
set.seed(123456789) # 设置随机种子，保证代码的可重复性

> sample(1:10, size=8) #默认不重复抽样
[1]  4  2  7  3 10  5  9  8

> sample(1:10, size=8, replace = T) #允许重复抽样
[1]  3  9 10 10  5  7  6 10
</pre>






<a name="2"></a>
<h2 class="tutheader">模拟</h2>










<a name="3"></a>
<h2 class="tutheader">拟合</h2>



<a name="3_1"></a>
<h3 class="tutheader">LOESS (locally estimated scatterplot smoothing) 平滑化</h3>
<p> Local Polynomial Regression Fitting 局部加权回归散点平滑法(locally weighted scatterplot smoothing，LOWESS或LOESS)。</p>
<p>参数 span 越大，平滑化程度越大，也就是越失真。</p>
<p>个人感觉: span大于0.8就不可信了。<a target=_blank href="https://tool.biomooc.com/R_scripts/#t9">点击查看应用demo</a> </p>
<pre>
步骤:
# 设置x坐标: x = seq(1, length(y) ); 如果已有x则跳过该步骤;
# 建模型 model1=loess(y ~ x, span=span)
# 预测新y值 y2=predict( model1 )
# 画图 plot(x,y2, lty='l')
</pre>
<img src="images/stat_sample_simu_fit/loess_demo.png"><br>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">#############
# LOESS 平滑化 核心函数
addLine=function(arr, span, color, ...){
  model2=loess(arr ~ seq(1, length(arr)), span=span)
  y2=predict( model2 )
  lines(y2, type="l", col=color, ...)
}

# settings
colors=rev(rainbow(7, start=0, end=9/10)); length(colors);
#barplot(rep(1,length(colors)), col=colors)

# make data
set.seed(10)
arr=rnorm(100, 10, 20);arr

#draw
par(mar=c(4,4,3,6))
plot(arr, type="l", xlab="x", ylab="y", col='grey', main="Loess demo")
#add line: arr, span, color
spans=c((1:5)/10,1,2 ); length(spans)
line=c(rep(1,6), 2,2); length(line)
for(i in 1:length(spans)){
  addLine(arr, spans[i], colors[i],lwd=line[i],lty=line[i])
}
#add legend
pos=par('usr');pos
legend(x=pos[2], y=pos[4], title="span",
       xpd=T, #show outside figure
       bty="n", #box type
  col=colors, legend=spans, lty=line, lwd=line)</div>
</div>


<a name="3_2"></a>
<h3 class="tutheader">局部加权回归LOWESS 平滑化</h3>
<p>图略。参数和loess一致时，图也基本一致。</p>
<p>f: the smoother span. This gives the proportion of points in the plot which influence the smooth at each value. Larger values give more smoothness.</p>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">y=mtcars$mpg # 造数据
set.seed(10) # 或则模拟一组
y=rnorm(40, 10, 20);y
#

n=length(y)
x=1:n
#
par(mar=c(4,4,3,6))
plot(x,y, type='o',col='grey',main="lowess demo")
#f 取不同的参数
lines(lowess(x,y, f = 0.2), col ='orange')
lines(lowess(x,y, f = 0.4), col ='blue')
lines(lowess(x,y, f = 0.6), col ='green')
lines(lowess(x,y, f = 0.8), col ='purple')
lines(lowess(x,y, f = 1), col ='cyan')
lines(lowess(x,y, f = 2), col ='red', lty=2, lwd=2)
#
pos=par('usr');pos
legend(x=pos[2], y=pos[4], title="f value", lty=1, 
       xpd=T, #show outside figure
       bty="n", #box type
       col=c('orange','blue','green','purple','cyan','red'),
       legend=c(0.2,0.4,0.6,0.8,1,2))</div>
</div>









<a name="100"></a>
<h2 class="tutheader">参考资料</h2>
<pre>


</pre>






			</div>
		</div>
		
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
	</div>
</div>







	
	
	
	
	










</div>

</div>

</body>
</html>