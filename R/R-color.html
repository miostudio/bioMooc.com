<!Doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>R 教程 | 生物慕课网</title>

<link rel="canonical" href="http://www.biomooc.com/R/R-tutorial.html" />
<meta name="keywords" content="R 绘图教程,R低水平绘图命令">
<meta name="description" content="R 绘图教程,R低水平绘图命令。">
		
	<link rel="shortcut icon" href="/img/favicon.ico" mce_href="/img/favicon.ico" type="image/x-icon" >
	<link rel="stylesheet" href="/wp-content/themes/biomooc/style.css?v=1.141" type="text/css" media="all" />	
	<link rel="stylesheet" href="/static/css/font-awesome.min.css" media="all" />	
<!--
	<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" media="all" />	  
-->
  <!--[if gte IE 9]><!-->
  <script src="/static/js/jquery.min.js"></script>
  <!--<![endif]-->
  <!--[if lt IE 9]>
     <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
     <script src="//cdn.bootcss.com/html5shiv/r29/html5.min.js"></script>
  <![endif]-->
  <link rel="apple-touch-icon" href="/img/mobile-icon.png"/>
  <meta name="apple-mobile-web-app-title" content="生物慕课网">

</head>

<style>
/*本页R代码过长: 最长n px,超过了出现滚动条*/
.maxHeight{max-height:400px; overflow:scroll;}


canvas {cursor: crosshair;}

.colorBox div{
	height: 50px;
    width: 60px;
    display: inline-block;
	text-align: center;
	padding: 0;
	margin:10px 0;
}
.colorBox div span{padding:2px; padding-bottom:8px; color:white;}
h4{margin-top:30px; border-left:3px solid black; padding-left:2px;}

p{text-indent: 2em;}
</style>

<body>
<!-- 头尾自动加载 -->
<script>
$(function(){
	$.get('/part/header-nav.html',function(data,status){
		$('body').prepend(data);//header-nav
	});
	
	$('<div id="footer" class="mar-t50"></div>').appendTo($("body"));
	$("#footer").load("/part/footer.html"); //footer
	
	$.get('/part/right-bottom-btn.html',function(data,status){
		$('#footer').after(data);//右下角按钮
	});

	
			
	//左右菜单
	$.get('./part/menu-left.html',function(data,status){
		$('.main .row').first().prepend(data);//左侧菜单-本文件夹内使用
	});
	
	$.get('/part/menu-right.html',function(data,status){
		$('.main .row').first().append(data);//右侧菜单-全局通用
		//没有事件，还需要绑定事件
		
		
	});
	
	$.getScript("/wp-content/themes/biomooc/assets/js/main.js?v=1.15");//回到顶部js文件
});
</script>


	
	

<!--  内容  -->
<div class="container main">
	<!-- 中间 -->
	<div class="row">
	





<div class="col middle-column">
		
	
	<div class="article">
			<div class="article-heading-ad" style="display: none;">
		
		</div>
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
		<div class="article-body">
		
			<div class="article-intro" id="content">
			
			<h1><span class="color_h1">R 色彩 </span> 详解与实例</h1>



<h2 class="tutheader">目录</h2>
<p><b>要点</b>: R中的色彩很丰富，灵活运用才能提高图片的美感和区分度。本文前面是色彩理论和实例，后面是R中相关函数。</p>

<ul>
	<li><a href="#0">色彩理论知识</a></li>
	<li><a href="#1">figure中的色彩实例</a>
		<ul>
			<li><a href="#1_1">色彩列表:微软的4种颜色</a>
			<li><a href="#1_2">示意图色彩</a>
			<li><a href="#1_3">条形图色彩</a>
			<li><a href="#1_4">色卡集合 (使用Canvas展示)</a>
		</ul>
	</li>
	<li><a href="#2">R 中的色彩函数</a>
		<ul>
			<li><a href="#2_0">查看颜色效果</a>
			<li><a href="#2_1">内置渐变色</a>
			<li><a href="#2_2">预置配色与自定义渐变色</a>
			<li><a href="#2_3">伪时间热图的渐变色设置原理</a>
			<li><a href="#2_4">连续型变量和渐变色的映射: cut()函数</a>
		</ul>
	</li>
	<li><a href="#3">ggplot2中的色彩函数</a></li>
	<li><a href="#100">色彩进阶参考</a></li>

</ul>

<p class=saying>A programmer who subconsciously views himself as an artist will enjoy what he does and will do it better.         —— Donald E. Knuth 1978
</p>



<p>简书笔记: 
	<a target="_blank" href="https://www.jianshu.com/p/8b0e34364b89">论文figure色彩实例 - 权衡美观与区分度</a> | 
	[推荐]<a target="_blank" href="https://www.jianshu.com/p/4e6fb1269ece">R语言中的渐变色</a> | 
	<a target="_blank" href="https://mp.weixin.qq.com/s?__biz=MzI5MTcwNjA4NQ==&mid=2247485182&idx=1&sn=7b5c1d800560eddcf898ed410720a2a3&scene=21#wechat_redirect">史上最全的图表色彩运用原理</a>
</p>
<hr />








<a name='0'></a>
<h2>色彩理论知识</h2>
<h3>SCI 图片用色的<a target="_blank" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">基本原则</a></h3>
<p>sci图片的目标: 整洁干净、简洁漂亮。</p>
<ul>
	<li>同一篇文章的图片颜色要注意色调的整体性，不宜出现特别鲜明刺眼的颜色（尤其是荧光绿）</li>
	<li>避免使用红绿，照顾色盲读者。可以使用红蓝代替。</li>
	<li>同一张图片色系最好统一，看起来会更加协调。</li>
	<li>同一个指标在全篇图片中最好都使用同一个颜色贯彻始终。</li>
	<li>一般用红色表示上调，绿色/蓝色表示下调。</li>
	<li>可以用渐变色来表示程度，颜色越深越多，颜色越浅越少，能够使数据显示更加直观。</li>
</ul>
<p>以上，就是 SCI 图片用色上的一些小技巧。</p>
<br>

<p>Nature Genetics 2016年发表一篇关于<a target="_blank" href="http://blogs.nature.com/freeassociation/2016/10/october-issue-cover-whats-going-on-here-2.html">包菜</a>的研究文章，使用了<a target="_blank" href="http://blogs.nature.com/freeassociation/files/2016/10/ng.3634-F1.jpg" title="点击查看物种聚类图">很多颜色</a>，怎么配色的？首先尽量避免扎眼的颜色，色彩的亮度要减少，以显得柔和，暖色系和冷色系要分开。是不是觉得很干净，很好看？</p>


<p>更复杂一些的，比如关于互补色、对比色的使用等颜色搭配相关的进阶知识，感兴趣的可以自行查看学习，对 SCI 图片或者是 PPT 的制作都是很有帮助的。</p>



<h3>色彩常用语名词解释</h3>
<p>可以直接用色轮中的相邻色和互补色确定主色。可以阅读 <a target="_blank" href="http://www.sthda.com/english/wiki/the-elements-of-choosing-colors-for-great-data-visualization-in-r">STHA.com 教程</a>: choosing-colors-for-great-data-visualization-in-r</p>

<p><a target="_blank" href="https://www.w3schools.com/colors/colors_palettes.asp">color palettes</a></p>
<p><a target="_blank" href="https://www.w3schools.com/colors/colors_wheels.asp">color wheels</a></p>
<p><a target="_blank" href="https://www.w3schools.com/colors/colors_schemes.asp">color schemes</a></p>
<p><a target="_blank" href="https://www.w3schools.com/colors/colors_psychology.asp">color psychology</a></p>

<p>单色(hue相同，饱和度不同)Monochromatic schemes use different tones from the same angle on the color wheel (the same hue).</p>
<p>相似色 Analogous color schemes are created by using colors that are next to each other on the color wheel.</p>
<p>互补色(hue在色轮两端) Complementary schemes are created by combining colors from opposite sides of the color wheel.</p>
<p>三色系 Triadic schemes are made up of hues equally spaced around color wheel.</p>
<p>复合方案 Compound schemes are almost the same as complementary schemes.
Instead of using colors that are opposites, it uses colors on both sides of the opposite hue.</p>










<a name='1'></a>
<h2 class="tutheader">figure中的色彩实例</h2>


<a name='1_1'></a>
<h3>色彩列表</h3>
<p>微软的四种颜色</p>
<style>
ul.color,
ul.color li{margin:0; padding:0; list-style-type: none;}
</style>
<ul class=color>
	<li>
		<span style="display:inline-block; background:#F65314; height:40px; width:40px;"></span>
		<span style="display:inline-block; background:#7CBB00; height:40px; width:40px;"></span>
	</li>
	<li>
		<span style="display:inline-block; background:#00A1F1; height:40px; width:40px;"></span>
		<span style="display:inline-block; background:#FFBB00; height:40px; width:40px;"></span>
	</li>
</ul>


<p>Google的四种颜色</p>
<ul class=color>
	<li>
		<span style="display:inline-block; background:#4285F4; height:40px; width:40px;"></span>
		<span style="display:inline-block; background:#FBBC05; height:40px; width:40px;"></span>
		<span style="display:inline-block; background:#34A853; height:40px; width:40px;"></span>
		<span style="display:inline-block; background:#EA4335; height:40px; width:40px;"></span>
	</li>
</ul>

<br>
<br>






<hr>
<a name='1_2'></a>
<h3>示意图色彩</h3>


<h4>10x单细胞示意图</h4>
<img src="images/color/color_002.png" /><br>


<h4>碱基颜色 1 (10x)</h4>
<div class=colorBox>
	<div style='background:#71BE4B'><span>A</span></div>
	<div style='background:#E84B50'><span>T</span></div>
	<div style='background:#FAC319'><span>G</span></div>
	<div style='background:#00A1DF'><span>C</span></div>
	<div style='background:#fff'><span></span></div>
	<div style='background:#ED245B'><span>Red</span></div>
	<div style='background:#B780E1'><span>Purple</span></div>
	<div style='background:#FE9E6F'><span>Orange</span></div>
</div>
<h4>碱基颜色 2 (其他来源)</h4>
<div class=colorBox>
	<div style='background:#F88E3A'><span>A</span></div>
	<div style='background:#616FB1'><span>T</span></div>
	<div style='background:#FDE255'><span>G</span></div>
	<div style='background:#0AB0E6'><span>C</span></div>
	<div style='background:#fff'><span></span></div>
	
	<div style='background:#009600'>IGV:<span>A</span></div>
	<div style='background:#FF0000'>IGV:<span>T</span></div>
	<div style='background:#D17105'>IGV:<span>G</span></div>
	<div style='background:#0000FF'>IGV:<span>C</span></div>
</div>



<h4>Cell cycle 1</h4>
<div class=colorBox>
	<div style='background:#EECAD6'>G1<br><span style="background:#C83279"> Cyclin D </span></div>
	<div style='background:#C5DCC2'>S<br><span style="background:#009551"> Cyclin E </span></div>
	<div style='background:#B4B2CA'>G2<br><span style="background:#273074"> Cyclin A </span></div>
	<div style='background:#EEC5AF'>M<br><span style="background:#F68041"> Cyclin B </span></div>
</div>

<h4>Cell cycle 2</h4>
<div class=colorBox>
	<div style='background:#5AC9FF'>G1 <br><span style="background:#0182D5"> Cyclin D </span></div>
	<div style='background:#FE8C72'>S <br><span style="background:#C90C12"> Cyclin E </span></div>
	<div style='background:#6E82C7'>G2 <br><span style="background:#092D83"> Cyclin A </span></div>
	<div style='background:#97CA51'>M <br><span style="background:#039131"> Cyclin B </span></div>
	<div style='background:#FFFFFF; border:1px solid #D2D2D2'>Inter <br><span style="background:#D2D2D2"> phase </span></div>
</div>


<br>
<br>







<hr>
<a name='1_3'></a>
<h3>条形图色彩</h3>

<h4>条形图</h4>
<img src="images/color/color_001.png" /><br>


<h4>色块图</h4>
<img src="images/color/color_patch.png" /><br>
<p>pubmed id:33846635</p>


<h4>bar 色块提取1</h4>
<div class=colorBox>
	<div style='background:#EE3523'>#EE3523</div>
	<div style='background:#919135'>#919135</div>
	<div style='background:#68CBDD'>#68CBDD</div>
	<div style='background:#F7921D'>#F7921D</div>
	<div style='background:#029052'>#029052</div>
	<div style='background:#902E8E'>#902E8E</div>
	<div style='background:#323B97'>#323B97</div>
	<div style='background:#00B8F0'>#00B8F0</div>
	<div style='background:#EC188B'>#EC188B</div>
</div>


<h4>bar 色块提取2</h4>
<div class=colorBox>
	<div style='background:#76573B'><br><span style="background:#452D23">item 01</span></div>
	<div style='background:#DC6C6B'><br><span style="background:#AF3D3C">item 02</span></div>
	<div style='background:#4BA6AB'><br><span style="background:#167B81">item 03</span></div>
	<div style='background:#E3DEBD'><br><span style="background:#D0BFA5">item 04</span></div>
	<div style='background:#D8E755'><br><span style="background:#ADBC2E">item 05</span></div>
	<div style='background:#3B78C8'><br><span style="background:#0248A4">item 06</span></div>
	<div style='background:#A3C87B'><br><span style="background:#487F32">item 07</span></div>
	<br>
	
	<div style='background:#8CC63F'></div>
	<div style='background:#29ABE2'></div>
</div>



<div class=colorBox id='color001'>
</div>
<script>
// 同画板2: NG2016, 包菜, 证明 相同颜色，显示效果不同。但是屏幕取色器认为是一样的。
var box1 = document.getElementById('color001');
var colors=['#FD6349', '#31CC30', '#FBD800', '#FF6FB5', '#E02046', '#078309', '#FF01FD', '#6F6F6F', '#446CFF', '#FDA602']
for(var i=0;i<colors.length;i++){
	var oSpan=document.createElement('span')
	oSpan.innerHTML=colors[i];
	//
	var oDiv=document.createElement('div')
	oDiv.setAttribute('style', 'font-size:8px; height:40px; background:'+colors[i])
	//
	oDiv.append(oSpan)
	box1.append(oDiv)
}
</script>



<hr>
<a name='1_4'></a>
<h3>色卡集合 (使用Canvas展示)</h3>
<p>如果使用Chrome浏览器，可以按F12打开控制台Console, 鼠标<b>单击</b>颜色，控制台输出16进制(hex)颜色值; <b>双击</b>则输出一整行unique color的hex值; 控制台带背景色的颜色字符可以复制粘贴。</p>

<p>小工具: 批量选取自己喜欢的颜色,  
	<a target="_blank" href="/color/colorWheel.html">批量By色环</a> | 
	<a target="_blank" href="/color/colorWheelBatch.html">批量ByL</a> | 
	<a target="_blank" href="/color/colorWheelBatch2.html">批量ByS</a> | 
	<a target="_blank" href="/color/colorPicker_PS.html">仿PS颜色设置</a> | 
</p>


<h4>Color Palette 1: 生活中的色彩</h4>
<canvas id="canvas_colorBar1" width="600" height="600" style="border:1px dashed #ccc;"></canvas>



<h4>Color Palette 2: CNS paper中单细胞可视化(tSNE/ UMAP/ heatmap/ boxplot) 经典配色</h4>
<canvas id="canvas_colorBar2" width="600" height="550" style="border:1px dashed #ccc;"></canvas>




<h4>Color Palette 3: 财经杂志 商务图表 知名网站</h4>
<canvas id="canvas_colorBar3" width="600" height="480" style="border:1px dashed #ccc;"></canvas>




<h4>Color Palette 4: HSL色彩模型</h4>
<canvas id="canvas_colorBar4" width="600" height="510" style="border:1px dashed #ccc;"></canvas>



<h4>Color Palette 5: barplot/lineplot 等色彩搭配</h4>
<canvas id="canvas_colorBar5" width="600" height="300" style="border:1px dashed #ccc;"></canvas>


<script>
	var ctx1 = document.getElementById('canvas_colorBar1').getContext('2d');
	var ctx2 = document.getElementById('canvas_colorBar2').getContext('2d');
	var ctx3 = document.getElementById('canvas_colorBar3').getContext('2d');
	var ctx4 = document.getElementById('canvas_colorBar4').getContext('2d');
	var ctx5 = document.getElementById('canvas_colorBar5').getContext('2d');
	
	// tool 1: 方框填充
	var showColors=function(ctx, colors, initHeight, text="", width=50, deltaH=0, height=20){
		var nPerRow=Math.floor(600/width)
		for(var i=0; i<colors.length; i++ ){
			var x=(i%nPerRow)*width
			var y=Math.floor(i/nPerRow)*(20+deltaH)+initHeight;
			ctx.fillStyle=colors[i]; ctx.fillRect(x,y,width,height);
		}
		ctx.fillText(text, x+width+5,y+15)
	}
	
	// tool 2: 圆形填充
	var showColors2=function(ctx, colors, initHeight, text="", width=50, deltaH=0, height=20){
		var nPerRow=Math.floor(600/width), r=width;
		for(var i=0; i<colors.length; i++ ){
			var x=(i%nPerRow)*width
			var y=Math.floor(i/nPerRow)*(height+deltaH)+initHeight;
			ctx.beginPath(); ctx.arc(x+r/2, y+r/2, r/2*0.95, 0, Math.PI*2); ctx.closePath();
			ctx.fillStyle=colors[i]; ctx.fill();
		}
		ctx.fillText(text, x+width+5,y+15+r/4)
	}
//




/**==========================
* 第1个色板: 自然色彩
*==========================*/
	//1
	showColors(ctx1,[ '#BB4791', '#DE99D0', 
		'#CA901B', '#F2B23B', 
		'#307832', '#BCCD7F', 
		],0, '荷花');
	
	//2
	showColors(ctx1,[
	'#8D1865', '#C6248F', '#FD41BD', '#FE91D9', '#FFCFEF', 
	'#0E5F0B', '#267D23', '#40B83B', '#78E874', '#BBFFB8', 
	'#1E2D91', '#293FC9', '#314DFB', '#7487FE', '#B6C0FF'
		],22, '樱花', width=35);
	//2.1
	showColors(ctx1,[
	'#347176',  '#41907D', /*'#56937E',*/ '#668051','#8CA883', 
	'#BA9359',  '#E19971', '#D45E3E',  '#DE3919',  
	'#EAEAE8','#E2DFCF', 
	'#8E3366', '#0B3981', 
	'white','#ED6C00','#2BB7B3', '#003F43'
	/*'#E46713','#01ABA8', */
		],45, 'sustech', width=30);
		
	//3
	showColors(ctx1,['#0B5652', '#00AEA9', '#5BEAE6',
		'#5D4022', '#944907', '#C5A27D', 
		], 75, '鼠标和纸盒子');
		
	//4
	showColors(ctx1,['#27921C', '#20CA25',  '#19D67D',//绿色
		 '#C7862F', '#DACE93','#E2D44A', //黄色 '#B8883E', 
		'#E00A3E', '#EB09C7', '#821B90', //红色
		'#1898FD', '#211DFC', //蓝色'#40CDE0', 
		], 100, '随机色彩');
	//5. 'G1S'="#66C2A5" 'S'="#FC8D62" 'G2M'="#8DA0CB" 'M'="#E78AC3" 'MG1'="#A6D854"
	//'6'="#FFD92F" '7'="#E5C494" '8'="#B3B3B3"
	showColors(ctx1,["#66C2A5", "#FC8D62", "#8DA0CB", "#E78AC3", 
		"#A6D854", "#FFD92F", "#E5C494", "#B3B3B3"], 125, 'R Set2')
	
	//6. 所谓的44种可分辨颜色
	showColors(ctx1,['#6c1717', '#b50b0b', '#ff0000', '#ff4c4c', '#ff9999', '#6c4e17', '#b5790b', '#ffa500', '#ffc04c', '#ffdb99', '#a52a2a', '#4f6c17', '#7bb50b', '#a8ff00', '#dcff99', '#0bb50b', '#00ff00', '#99ff99', '#17a16d', '#12e193', '#a0f4d4', '#0b610b', '#008000', '#4caa4c', '#99d599', '#0b0bb5', '#0000ff', '#4c4cff', '#9999ff', '#0d75f8', '#559efa', '#0bb5b5', '#00ffff', '#99ffff', '#b50bb5', '#ff00ff', '#ff4cff', '#ff99ff', '#800080', '#aa4caa', '#d599d5', '#730bb5', '#9c00ff', '#ba4cff'], 160, '44ByRGB', 12.5)
	showColors(ctx1,['#0b610b', '#6c1717', '#6c4e17', '#4f6c17', '#008000', '#800080', '#17a16d', '#a52a2a', '#4caa4c', '#aa4caa', '#b50b0b', '#b5790b', '#7bb50b', '#0bb50b', '#0bb5b5', '#0b0bb5', '#730bb5', '#b50bb5', '#99d599', '#d599d5', '#12e193', '#a0f4d4', '#0d75f8', '#559efa', '#ff9999', '#ffdb99', '#dcff99', '#99ff99', '#99ffff', '#9999ff', '#ff99ff', '#ff4c4c', '#ffc04c', '#4c4cff', '#ba4cff', '#ff4cff', '#ff0000', '#ffa500', '#a8ff00', '#00ff00', '#00ffff', '#0000ff', '#9c00ff', '#ff00ff'], 185, '44ByHSL', 12.5)
	
	//7. 浅色
	showColors(ctx1,['#B7B6BE', '#929199', '#A3DBAC', '#87BF90', '#E07C58', '#C25E39', '#BBA28E',  '#AD9480', 
		'#F2D458', '#CBAD31', '#F9E2D2', '#DFC8B8', '#FCC2D7', '#DDA6B8', '#72BDCB', '#2B828D', 
	], 220, '浅色', 25)
	
	//8. 
	showColors(ctx1,['#F4C434', '#F18031', '#EB4742', '#872817', '#E86AEA', '#92357F', 
		'#B85DE8', '#7640C4', '#C67E76', '#8B6161', 
		'#B85D5A', '#7C2626', '#EFEBAC', '#E8B52F', '#A4AC3F', '#CDD25F', 
		'#60C87E', '#317040', '#EA4E8D', '#D84B71'
		], 245, '颜料盒', 25)
	
	//9. 彩色折纸
	showColors(ctx1,[
	'#F95F7F', '#FE9C68', '#F8D24F', '#4DBDB3','#7FE497', '#48CCFD', 
	'#8050C0', '#A79EFB',  '#FD87D3','#F7B4E7', '#826373','#CFB789', //3 pair2
	'#F3EEEF', //white
		   '#5667C3', '#CBEDC8','#A8E1FF'
		   ],270, '彩色折纸', 25)
	//10. 
	showColors(ctx1,[
		'#ED285D', '#DFF1F8', '#8ECDE7','#00B0E3', 'white',
		'#0A9AD7', '#F9C506', '#62BA46', '#ED245C', '#888B8D','white',
		'#E84B50', '#EFBC1B', '#00B398', '#153057', '#00A1DF', '#71BE4B', '#965EC8', '#999999', '#00AB9F',
		   ],300, '10X genomics', 25)
	
	//11
	showColors(ctx1,[
		'#E34595', '#C50F55', '#A10328', '#F3DF37', '#DFC425', '#AE8605', 
		'#B5CE37', '#4E8A06', '#426B16', '#FBC867', '#DF7731', '#9C0402', 
		'#411C0B', '#D7B984', '#201F24',
	], 330, '线团', 30, deltaH=2)

	//12
	showColors(ctx1,[
		'#B2FDFD', '#01DDFA', '#01AFDD', '#834E24', '#F6D738', '#FD8E03', '#FA4101', '#BABABA',
		'#FFFFDA','#F59038', '#F9671A'
	], 360, '蝴蝶', 30, deltaH=2)



	//100. 大自然
	showColors(ctx1,[
		'#F98866', '#FF420E', '#80BD9E','#89DA59', '#FFFFFF', //花朵Fresh & Bright
		'#90AFC5', '#336B87', '#2A3132', '#763626', '#FFFFFF', //Subdued 
		'#46211A', '#693D3D', '#BA5536', '#A43820', '#FFFFFF', // Dark & Earthy
		'#505160', '#68829E', '#AEBD38', '#598234', '#FFFFFF', // 04 Crisp & Dramatic
		'#375E97', '#FB6542', '#FFBB00', '#3F681C', '#FFFFFF', // 08. Primary Colors With a Vibrant Twist
		'#98DBC6', '#5BC8AC', '#E6D72A', '#F18D9E', '#FFFFFF', // 09. Refreshing & Pretty
		'#4CB5F5', '#B7B8B6', '#34675C', '#B3C100', '#FFFFFF', // 11. Fresh & Energetic
		'#F4CC70', '#DE7A22', '#20948B', '#6AB187', '#FFFFFF', // 12. Surf & Turf
		'#F52549', '#FA6775', '#FFD64D', '#9BC01C', '#FFFFFF', // 20. Bright & Tropical
		'#50312F', '#CB0000', '#E4EA8C', '#3F6C45', '#FFFFFF', // 22. Bold Berries
		'#4D85BD', '#7CAA2D', '#FCD302', '#CB6318', '#FFFFFF', // 23. Summer Sunflower
		'#00293C', '#1E656D', '#F1F3CE', '#F62A00', '#FFFFFF', // 25. Timeless & Nautical
		'#258039', '#F5BE41', '#31A9B8', '#CF3721', '#FFFFFF', // 27. Cheerful Brights
		'#5C8F22', '#752A07', '#FBCB7B', '#EB5E30', '#FFFFFF', // 29. Summer Barbeque
		'#F70025', '#F7EFE2', '#F25C00', '#F9A603', '#FFFFFF', // 31. Lemonade Stand
		'#A1BE95', '#E2DFA2', '#92AAC7', '#ED5752', '#FFFFFF', // 32. Serene & Spa-Like
		'#4897D8', '#FFDB5C', '#FA6E59', '#F8A055', '#FFFFFF', // 33. Fun & Tropical
		'#AF4425', '#662E1C', '#EBDCB2', '#C9A66B', '#FFFFFF', // 34. Spicy Neutrals
		'#4C3F54', '#D13525', '#F2C057', '#486824', '#FFFFFF', // 36. Bold & Cultured
		'#F77604', '#B8D20B', '#F56C57', '#231B12', '#FFFFFF', // 40. Neon Night
		'#F47D48', '#E2305A', '#FDEC5C', '#018DCB', '#FFFFFF', // 60. Candy-Coated Brights
		'#A5C9BB', '#EAB364', '#B3473E', '#ADBC77', '#FFFFFF', // 61. Muted & Antique
			
		'#000000',
		], 410, '大自然 4 色组合', 30,deltaH=2)
		
	
	
	
	
	

/**==========================
* 第2个色板: cns文章色彩
*==========================*/
	//1. umap colors:nb ansuman 2019 massively parallel: https://www.nature.com/articles/s41587-019-0206-z/figures/3
	showColors(ctx2,[
		'#6F4B9C', '#F9E800', '#BE71AF', '#3ABCA5', '#88288D', '#8C9FD2', '#F5797C', '#D71E26', '#D9A86A', '#D44D28', 
		'#91D5E5', '#87C963', '#208A41', '#F57F2C', '#293069', '#9A83BD', '#FFFFFF',
		'#495A90', '#7C8C6F', '#C99C62', 
		'#2A585D', '#BF5F59', '#5287A4', '#8F2F22',
		], 5, 'nb 2019, Ansuman, scATAC', 19)
	//2.
	showColors(ctx2,[
		'#A2C7DA', '#73C5D3', '#3F879F', '#3F9546', '#69B546', '#93C48D',    '#DA3D2F', '#866269', 'white', //umap组1
		'#B49674', '#E2A226', '#E26A46', '#E58F70', '#E57371', '#E76DA2', '#C5AAC3', '#7D5A92', '#BE2583', '#D7CE96', '#648BC9', '#A95729', 'white',//umap组2
		'#1D1E89', '#7E348A', '#9E0A5A', '#07A49D', '#595957', '#F6B62A', '#888888', //基因类型，深色
		], 35, 'N2018, ZhangZM, tSNE', 27, deltaH=2)
	showColors(ctx2,[
		'#62C8D5', '#428DA8', '#83C35F', '#8FCA98', '#E7443B', '#E0B122', '#18A8BD', 'white', //boxplot颜色
		'#F9F398', '#B05928', '#359E4A', '#FDBF6E', 'white', // 热图分类color1
		'#CAB2D6', '#E11F27', '#A6CCE0', '#1F78B3', '#B2D589', '#F79D9C', '#6B3F97', '#F47F21', // 热图分类color1
		], 85, 'N2018, ZhangZM, heatmap', 22, deltaH=2)
	//3.
	showColors(ctx2,[
		'#E41A1C', '#E6F5C9', '#377EB8', '#4DAF4A', '#F4CAE4', '#FFFF33', 
		'#A65628', '#B3E2CD', '#CBD5E8', '#999999', '#FF7F00',  '#F781BF', '#FDCDAC', 'white', //tSNE cluster
		'#D85DBD', '#06FF69', '#6C5B9B', '#1E77FE', '#0000FF', '#FDB408', '#A65628', '#00ECE5', 'white', //Cloud;
		'#F5816C', '#71FFFF', '#003BFF', 'white',
		'#1B9D76', '#DA5F02', '#7570B2', '#E7298B', '#66A61E', 'white',
		'#A6CEE2', '#B3DF86', '#FF7F00', '#FB9AFF', '#1E78B5', '#984FA3', '#FEBF00', '#E31A1D', '#339F2A', '#CA00D6','white', //细胞类型
		'#7FC980', '#BEAED3', '#FCC088', '#FE8AD1', '#386CB0', //patient ID
		], 110, 'N2019, 脑胶质', 22, deltaH=2)
	
	//4.
	showColors(ctx2,[
		'#FDC06D', '#1579B6', '#6A3D97', '#E51E27', '#B15A26', '#2CA247', '#B3D88C', '#F69B9B',  '#A7CFE4', '#F58022', '#CBB4D7', 'white', // tumor type 
		'#1BB1E7', '#31B557', '#F79033', '#E54459', '#5F6EB4', '#BDBEC1', 'white',//突变类型
		'#C08EA9', '#4FA651', '#516FA2', '#B06728', '#E51E27', 
			'#747B78', '#F8991D', '#E27598', '#9B9A9B', '#42A16C', '#F3EC3B', '#C26257', 
			'#368B9D', '#9C425C', '#9452A0', '#BF6067','#FDCF16', '#D4AF29', '#E986B7', '#EA7425','white', //基因类型: TF, 组蛋白，基因组完整性，RTK信号，细胞周期等
		'#6A3E98', '#1A79B5', '#2FA147', '#E41E27', '#FDBF6D', '#B3D78B', '#F6999A', '#F57F22', '#CAB2D6', '#A6CFE4', '#B05927', 'white',//boxplot dark
		'#B4A2CE', '#A6BCDD', '#B1D1A9', '#F4A88E', '#FEE3BF', '#DEEECD', '#FBD4D0', '#FDC89A', '#E8DDED', '#DAEAF4', '#DBB192', //boxplot light
		], 170, 'N2013, TCGA, Mutational landscape', 22, deltaH=2)
	//5.
	showColors(ctx2,[
		'#E6151B', '#E4C906', '#9DCD69', '#28692F', '#0C8E72', '#2F72B6', '#2295B4', '#40C0E3', '#F082A5', '#AD1D5B', '#E4CE18', '#6FBB34', 'white',// 物种分类聚类图
		'#FD6349', '#31CC30', '#FBD800', '#FF6FB5', '#E02046', '#078309', '#FF01FD', '#6F6F6F', '#446CFF', '#FDA602'//基因组散点图
		], 250, 'NG2016, 包菜', 22, deltaH=2)
	
	//6.
	showColors2(ctx2,[
		'#F9A31C', '#6BCCDF', '#F01A2A', '#B84E9D', '#ECEB5C',
		], 275, 'nature 2013,GPCR', 22, deltaH=2)
	
	//7. Immunogenomic Landscape of Hematological Malignancies
	showColors(ctx2,[
		'#0098D1', '#AB4B4B', 'white',
		'#CEABAF', '#B2D0B8', '#FFAD7D', '#ABC2C4', '#B3B414', 
		'#EAEAEA', '#E488A6', '#A699B5', 'white',
		'#8A4BAC', '#BF8D93', '#F9C155', '#256C35',  '#50C173',  '#CD7BC1', 'white',
		'#659698', '#C48787', '#DA1D5B', '#594378'
		], 300, 'cancer cell, 2020', 20, deltaH=2)
	// 8.
	showColors(ctx2,[
		'#122A00', '#75B82A', '#E5CA83', '#BE9190', '#D65F91', '#A87070', '#F94559', 'white', 
		'#ADE0E5', '#0BBEFD', '#7633F9', '#0581F5', '#31A0D8', '#00607C', '#0F32A5', '#04A7B4' 
		], 322, 'cancer cell, 2020', 20, deltaH=2)
	// 9. https://www.embopress.org/journal/17444292
	showColors(ctx2,[
		'#FEDA14', '#84006D', '#027A6E', '#724D3B', '#FA9312', '#03A3C7', '#E31963', '#79BE6E', '#6A6E6F'
		], 344, 'embopress.org', 20, deltaH=2)
	// 10. 
	showColors(ctx2,[
		'#F1675D', '#A05F94', '#03B9AC', '#EBEBEB', '#474747', '#00558B','#0197DB', '#43AF2A', '#D82924','white',
		'#CE056D', '#E5BC50', '#009EB1',
		], 369, 'elsevierdigitaledition.com', 20, deltaH=2)

	//11. 单细胞珍藏颜色 40 个
	showColors(ctx2,["#DC143C","#0000FF","#20B2AA","#FFA500","#9370DB","#98FB98","#F08080","#1E90FF","#7CFC00","#FFFF00","#808000","#FF00FF","#FA8072","#7B68EE","#9400D3","#800080","#A0522D","#D2B48C","#D2691E","#87CEEB","#40E0D0","#5F9EA0","#FF1493","#0000CD","#008B8B","#FFE4B5","#8A2BE2","#228B22","#E9967A","#4682B4","#32CD32","#F0E68C","#FFFFE0","#EE82EE","#FF6347","#6A5ACD","#9932CC","#8B008B","#8B4513","#DEB887"], 395, '单细胞珍藏40色', 13)	
	
	
	//100. CNS 色彩
	showColors(ctx2,[
		// nature杂志配色
		'#E82162', '#AF4A9C', '#25B88C', '#E7B773', '#EDE4DD', '#FFFFFF',
		'#EB98A0', '#CE9BC2', '#E5C575', '#EAB98B', '#EDE4DD', '#FFFFFF',
		'#E82364', '#5BC4BA', '#37B770', '#24729D', '#D0A494', '#FFFFFF',
		'#18ABC8', '#91B63D', '#E9B772', '#E86064', '#ECE6DB', '#FFFFFF',
		'#ECB9BF', '#516A8A', '#A5CDEA', '#ECC8A9', '#ECE6DB', '#FFFFFF',
		'#2696C9', '#E7C272', '#CF605D', '#EB9391', '#EDEDED', '#FFFFFF',
		'#EB77A5', '#E41E25', '#F0810E', '#25AB3A', '#1179C1', 'white', //2018 张泽民
		'#E6007D', '#F9B234', '#FCEA10', '#35B3A6', '#1D71B8', '#95C11F', '#82368C', '#36AFE5',
		'#D1D0CB','#BC1E2D', '#E23929', 'white', 
		'#BC42AC', '#7868C0', '#DEB82D', '#3A9425', '#B96A6D', '#C3B8B7', 'white', //barplot
		'#5DB3DC', '#66C00F', 'black','#AFEDE0', '#FFF6BC', '#D1C9EF', '#FD8B7B', '#93B9D8', '#FEBE65', 'white',//barplot in ggplot2
		'#9C1CAB', '#A8958F', '#F59200', '#79C714', '#00A3D3', '#111212', 'white',
		'#971B1E', '#0055A6', '#8DD8F8', '#8EC63F', '#006F3B', '#C0252D',  		'#CDCCCC', '#807F7F', '#B8E3F9','#1E62AC', '#A888BF','#583694', 'white',
		
		'black'
	], 440, 'nature 杂志色彩组合', 25,deltaH=2)
	



/**==========================
* 第3个色板: 商务图表 知名网站
*==========================*/
	// 1
	showColors(ctx3,[
		'#D5E4EB', '#6594A4', '#004D63', '#02A3E1', '#ADADAF', 'white', 
		'#F8F2E4', '#D1BB65', '#D6695C', '#5F8CA6', '#63A577', 
	], 5, '经济学人', 40,deltaH=2)
	// 2
	showColors(ctx3,[
		'#E7EAED', '#2B579A', '#A5B9D1', '#217346', '#9FCDB3', '#B7472A', '#FAC7B3', 
	], 30, 'ms office color', 40,deltaH=2)
	// 3
	showColors(ctx3,[
		'#DE7E1E', '#002E5F','#AFB5C0','#417630', 'white',  
		'#A61F7D','#DAABB4',/*桃红-浅*/  '#005652','#9ED6D3', /*重绿-浅*/ 'white',
		'#661F43','#F0C082','#8FD400',  '#0082C0', 'white',
		'#9ED6D3',  '#9E392A',  '#F07B05', '#0082C0', 'white',
		'#96C83A', '#007BBB',     '#EB771F', '#0E2B52',     '#ECAA21', '#487433',     
		'#5AB7B2', '#004E49',     '#B21D81', '#64203E', 
	], 60, 'GeneCards', 30,deltaH=2)
	// 4
	showColors2(ctx3,[
		'#173F5F', '#20639B', '#3CAEA3', '#F6D55C', '#ED553B', 'white', 
		'#1ABC9C','#DBFAF4','#F0B37E','#FFEDCC','#6AB0DE','#E7F2FA',
		"black"
	], 115, 'web UI', 30)
	
	// 5
/* Light Green /Green/Dark Green/Magenta/Light Purple/
Purple/Dark Purple/Darken/Teal/Light Blue/
Blue/Dark Blue/Yellow/Orange/Dark Orange/
Red/Dark Red/ */
	showColors(ctx3,[
		'#99b433', '#00a300', '#1e7145', '#ff0097', '#9f00a7', 
		'#7e3878', '#603cba', '#eff4ff','#1d1d1d',  'white',
		'#00aba9', '#2d89ef', '#2b5797', '#ffc40d', '#e3a21a', '#da532c', 
		'#ee1111', '#b91d47', 
	], 160, 'Metro UI', 60, deltaH=2, 20)

	//6 PicPick 柔和色
	showColors(ctx3,[
		'#000000', '#7F7F7F', '#880015', '#ED1C24', '#FF7F27', '#FFF200', '#22B14C', '#00A2E8', '#3F48CC', '#A349A4',
		'#FFFFFF', '#C3C3C3', '#B97A57', '#FFAEC9', '#FFC90E', '#EFE4B0', '#B5E61D', '#99D9EA', '#7092BE', '#C8BFE7',
	], 210, 'PicPick', 55, deltaH=2, 20)
	//7
	showColors(ctx3,[
		'#C00000', '#FF0000', '#FFC000', '#FFFF00', '#92D050', '#00B050', '#00B0F0', '#0070C0', '#002060', '#7030A0', 
	], 260, 'PPT 标准色', 50, deltaH=2, 20)


	//8
	showColors(ctx3,[
		'#BBCC33','#A5A500', '#74A5D7', '#E78463', '#E3D382', '#F8A5B6', '#95D7F8', '#42B695', '#DDDDDD',  
	], 290, 'blind friendly palettes', 50, deltaH=2, 20)

	//9
	showColors(ctx3,[
		'#BD1829','#F79421', '#844A9C', 'white', //metascape
		'#9DD29C', '#00AEEF', '#EC008C', '#D1D3D4', '#AAE1FA', //https://upload.wikimedia.org/wikipedia/commons/f/f4/Histone_tails_and_their_function_in_chromatin_formation.svg
		'#EFEFEF',  '#FFA8AA','#FF8288','#F23D45', '#FFDFA9','#FFCC80','#FFBA52','#F2A93D',  '#B1D8FC','#80C7FF','#309DF2','#0078D4',  '#E2F2D2','#ACCE79','#0FAD2C','#FF0404', '#CCCCFF', '#006699','#990000',
	], 315, 'wiki', 20, deltaH=2, 20)
	
	//10
	showColors2(ctx3,[
		'#32A1CE', '#C84F44', '#3F9765', '#DDB925', 'black'  //https://zhuanlan.zhihu.com/p/29126173
		
	], 340, '弧形漏斗图', 30, deltaH=2, 20)	
	//11
	showColors(ctx3,[
		'#e41a1c', '#377eb8', '#4daf4a', '#984ea3', '#ff7f00', '#ffff33', '#a65628', '#f781bf','#999999'
	], 375, 'python Set1', 40, deltaH=2, 20)
	//12 https://www.spandidos-publications.com/mmr/9/5/1597
	showColors(ctx3,[
		'#961750', '#e72287', '#ff870a', '#3ea33a', '#007361', '#8ac5c1', 
		'#00abf1', '#332a85', '#0b617c', '#5f1515', '#af59a2',
	], 400, 'spandidos-publications.com', 40, deltaH=2, 20)
	//13 https://www.cnblogs.com/rgqancy/p/7325536.html
	showColors(ctx3,[
		'#AA7A53', '#F0E6CE', '#FFFBF0', '#FEFEF2', '#F3E6CF', 
		'#AFBBBF', '#666666', 
	], 425, '咖啡色博客主题', 40, deltaH=2, 20)
	//14 邮件中的圆圈边框，中间是同色年份
	showColors(ctx3,[
		'#5CC0C0', '#6D6192', '#F6ACC3', '#5695B8', 
		'#D06160', '#54895F', '#EDB267', '#A853CB', 
	], 450, '邮件圆圈', 40, deltaH=2, 20)





/**==========================
* 第4个色板: HSL色彩模型、算法获得的颜色
*==========================*/
	var get_HSL_color=function(hue){
		var arr=[];
		for(var i=100; i>=0;i-=5){
			arr.push( "hsl("+hue+",100%,"+i+"%)" );
		}
		//console.log(arr)
		return arr;
	}
	//1
	// http://www.chaospro.de/documentation/html/paletteeditor/colorspace_hsl.htm
	// http://www.chaospro.de/documentation/html/intro/intro.htm 分形软件
	ctx4.save()
	ctx4.font="bold 12px Arial"; //文字样式
	ctx4.fillStyle="#000"
	for(var i=0; i<=20; i++){
		ctx4.fillText(i*5, i*25+5,10);
	}
	ctx4.fillText('Lightness%', 21*25+5,10);
	ctx4.restore();
	showColors(ctx4, get_HSL_color(0), 15, 'hue=0', 25)
	showColors(ctx4, get_HSL_color(60), 15+22, 'hue=60', 25)
	showColors(ctx4, get_HSL_color(120), 15+22*2, 'hue=120', 25)
	showColors(ctx4, get_HSL_color(180), 15+22*3, 'hue=180', 25)
	showColors(ctx4, get_HSL_color(240), 15+22*4, 'hue=240', 25)
	showColors(ctx4, get_HSL_color(300), 15+22*5, 'hue=300', 25)
	// more colors:
	var MAX={X:25*21, Y:360};
	for(var x=0;x<=MAX.X;x++){
		var lightness=x/MAX.X*100
		for(var y=0;y<=MAX.Y; y++){
			var hue=y/MAX.Y*360;
			var color="hsl("+hue+",100%,"+lightness+"%)"
			ctx4.fillStyle=color;
			ctx4.fillRect(MAX.X-x,y+ 15+22*6,1,1)
		}
	}



/**==========================
* 第5个色板: barplot/lineplot 等色彩搭配
*==========================*/
	//1
	showColors(ctx5,[ '#5BC4BA', '#E82364' ],0, 'barplot(2 colors)', width=100);
	showColors(ctx5,[ '#8B72AE', '#74AD43', '#CA495B', '#D3D3D3'  ],25, 'dotplot(highlight 3 colors)|PNAS', width=100); //https://www.pnas.org/content/115/28/E6437
	showColors(ctx5,[ '#D59F1C', '#84B5E4' ],50, 'violin(2 colors)', width=100);
	showColors(ctx5,[ '#497AA2', '#AE3137' ],75, 'barplot, R: steelblue, darkred', width=100);


</script>
<script type="text/javascript" src="part/canvas_tools.js"></script>

<br>
<br>













<a name='2'></a>
<h2 class="tutheader">R 中的色彩函数</h2>
<p>如何使用R语言画出漂亮的图，颜色很重要，既要协调，又要有一定的分辨力。</p>
R原生的颜色请参考本站 <a href="R-draw-basic.html#22">R 颜色</a>。


<a name='2_0'></a>
<h3 class="tutheader">查看颜色效果</h3>
<pre>
R中目测查看几种颜色的区分度: 
scales::show_col( c('red','blue', '#FF9600', '#0096FF') )
barplot(rep(1,4), col=c('red','blue', '#FF9600', '#0096FF'), border = NA)

library(scales)
show_col(viridis_pal()(16), labels = FALSE)
show_col(hue_pal()(9), borders = NA) #效果见下图
</pre>
<img src="images/color/show_col.png" /><br>


<br>
<p>还可以使用 barplot() 及 image() 来预览颜色。</p>
<div class="code notranslate">
	<div style="white-space: pre-wrap;"># 1.使用 barplot() 预览颜色
palette() # R4.0 默认调色盘相对 R3.6 下调了饱和度，看着更舒服。
#"black"   "#DF536B" "#61D04F" "#2297E6" "#28E2E5" "#CD0BBC" "#F5C710" "gray62" 
cols=palette()

par(mar=c(0,0,4,0))
posX=barplot(rep(1,8), col=cols, yaxt="n", border = NA)

text(posX, 1.05, labels=cols, 
     srt=60, adj=0,
     col="black", xpd=T)

# 2.使用 image() 预览颜色
# 按照Set1的配色的前8种
par( mar=c(1,0,4,1))

library(RColorBrewer)
mypalette_1=brewer.pal(8,"Set1")
mypalette_1
# "#E41A1C" "#377EB8" "#4DAF4A" "#984EA3" "#FF7F00" "#FFFF33" "#A65628" "#F781BF"
image(1:8,1,as.matrix(1:8),col=mypalette_1,
      xlab="Set1", ylab="", mgp=c(0.1,0.5,0),
      xaxt="n",yaxt="n",bty="n")
par("usr")
text(1:8, par("usr")[4]*1.03, labels=mypalette_1, 
     srt=60, adj=0,
     xpd=T,
     col="black", xpd=T)</div>
</div>
<img src="images/color/color_a0.png" /><br>
<br>




<a name='2_1'></a>
<h3 class="tutheader">1. R 内置渐变色</h3>
<p><b>彩虹色</b></p>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">#可以拿到任意多个颜色，当然颜色越多，分辨力越低。
barplot(rep(1,8), col=rainbow(8),border=NA, axes=F)
rainbow(8)
# [1] "#FF0000FF" "#FFBF00FF" "#80FF00FF" "#00FF40FF" "#00FFFFFF" "#0040FFFF"
# [7] "#8000FFFF" "#FF00BFFF"

barplot(rep(1,20), col=rainbow(20),border=NA, axes=F) #分辨力降低</div>
</div>
<br>


<p><b>其他几个预置渐变色</b></p>
<img src="images/color/color_a1.png" /><br>
<div class="code notranslate">
	<div style="white-space: pre-wrap;">par(mfrow=c(5,1), mar=c(0,0,2,0))
n=10

barplot(rep(1,n), col= rainbow(n), border=NA,axes=F, main="rainbow") #彩虹色

#heat.colors()从红色渐变到黄色，再变到白色
barplot(rep(1,n), col= heat.colors(n), border=NA,axes=F, main="heat.colors") 

#terrain.colors() 从绿色渐变到黄色，再到棕色，最后到白色 
barplot(rep(1,n),col=terrain.colors(n), border=NA,axes=F, main="terrain.colors")

#topo.colors() 从蓝色渐变到青色，再到黄色，最后到棕色 
barplot(rep(1,n),col=topo.colors(n), border=NA,axes=F, main="topo.colors")

#cm.colors() 从青色渐变到白色，再到粉红色
barplot(rep(1,n),col=cm.colors(n), border=NA,axes=F, main="cm.colors")</div>
</div>
<br>




<a name='2_2'></a>
<h3 class="tutheader">2. 预置配色与自定义渐变色</h3>
<p>使用预置配色集合 Set2/Dark2，通过函数colorRampPalette()插值生成任意个渐变颜色。</p>
<img src="images/color/color_a2.png" /><br>

<div class="code notranslate">
	<div style="white-space: pre-wrap;">library(RColorBrewer)
display.brewer.all() #显示全部颜色集合


## 选一个颜色集合，比如Dark2, Set2
display.brewer.pal(n = 8, name = 'RdBu')

csn='Dark2'
myColors=brewer.pal(8,csn) #该主题有n种颜色


par( mfrow=c(3,1), mar=c(0,1,1,0)) #bottom, left, top, right
barplot(rep(1,8),col= myColors, main=csn, axes=F,border=F)
# 插值，生成15个颜色
n=15
colorN=colorRampPalette(colors = myColors, interpolate ="linear")( n )
barplot(rep(1, n ),col= colorN, axes=F, border=F,
        main="linear") #插值方式
colorN2=colorRampPalette(colors = myColors, interpolate ="spline")( n )
barplot(rep(1, n ),col= colorN2, axes=F, border=F,
        main="spline") #插值方式</div>
</div>
<br>




<a name='2_3'></a>
<h3 class="tutheader">伪时间热图的渐变色设置原理</h3>
<p> monocle 的pseudotime_heatmap的配色很显眼，十分值得借鉴。 本文只关心渐变色生成部分。</p> 
<p> 整个图的画法请参考: <a target="_blank" href='https://tool.biomooc.com/R_scripts/#t9'>伪时间平滑化热图 plot_pseudotime_heatmap (仿monocle)</a> </p>
<img src="images/color/color_a3.png" /><br>


<div class="code notranslate maxHeight">
	<div style="white-space: pre-wrap;">############### color bar from monocle::plot_pseudotime_heatmap ##############
# 这个 color bar 来自于monocle，画热图效果很好
height = 1
n=22; mid=0.75;sill=0.25;base=1

table.ramp = function (n, mid = 0.5, sill = 0.5, base = 1, height = 1) {
  
  x <- seq(0, 1, length.out = n) #0-1之间取n个值
  y <- rep(0, length(x)) #等长度的0
  
  ### 定义极值 still
  sill.min <- max( c(1, round( (n-1)*(mid-sill/2) ) + 1) ) #14
  sill.max <- min( c(n, round( (n-1)*(mid+sill/2) ) + 1) ) #19
  
  ########## 替换0 平台期: 围绕mid的sill极值范围内的y取1
  y[sill.min:sill.max] <- 1
  y
  
  ### 定义 极值 base , 范围更宽
  base.min <- round( (n-1)*(mid-base/2) ) + 1 #6
  base.max <- round( (n-1)*(mid+base/2) ) + 1 #27
  
  ########## 替换1 上升部分
  # xi是 still到base的min过渡态, yi则是等长的0-1之间的间距值
  xi <- base.min:sill.min #[1]  6  7  8  9 10 11 12 13 14
  yi <- seq(0, 1, length.out = length(xi))
  # [1] 0.000 0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000
  
  # 获取xi中大于0小于等于n的元素的下标
  i <- which(xi > 0 & xi <= n) #[1] 1 2 3 4 5 6 7 8 9
  y[xi[i]] <- yi[i] #让y在这些位置上[6,14]，值等于yi
  y
  
  
  ########## 替换2 下降部分
  # xi是 still到base的max过渡态, yi则是等长的1-0之间的间距值
  xi <- sill.max:base.max # [1] 19 20 21 22 23 24 25 26 27
  yi <- seq(1, 0, length.out = length(xi))
  #[1] 1.000 0.875 0.750 0.625 0.500 0.375 0.250 0.125 0.000
  
  i <- which(xi > 0 & xi <= n) #[1] 1 2 3 4
  y[xi[i]] <- yi[i]
  y
  
  height * y
# [1] 0.000 0.000 0.000 0.000 0.000 0.000 0.125 0.250 0.375 0.500 0.625 0.750 0.875
#  [14] 1.000 1.000 1.000 1.000 1.000 1.000 0.875 0.750 0.625
}


height=1
n=10
#do.call("table.ramp", as.list(c(n, c(0.8, 0.2, 1)))) #等价于
rr=table.ramp(n, 0.8,0.2,1); rr
#[1] 0.0000000 0.0000000 0.0000000 0.0000000 0.3333333 0.6666667 1.0000000
#[8] 1.0000000 1.0000000 0.7500000
gg=table.ramp(n, 0.5,0.4,1); gg
#[1] 0.0000000 0.3333333 0.6666667 1.0000000 1.0000000 1.0000000 1.0000000
#[8] 0.6666667 0.3333333 0.0000000
bb=table.ramp(n, 0.2,0.2,1); bb
#[1] 0.7500000 1.0000000 1.0000000 1.0000000 0.6666667 0.3333333 0.0000000
#[8] 0.0000000 0.0000000 0.0000000

par(mfrow=c(2,1), mar=c(2,2,0,1)) #b,l,t,r
plot(rr, xlim=c(0.5,n+0.5), ylim=c(0,1), type='o', col='red', xaxt='n')
axis(1, at=seq(1, n), labels=seq(1,n)/10, las=2,cex.axis=0.7)
lines(gg, col='green', type='o')
lines(bb, col='blue', type='o')
#
hmcols=rgb(rr, gg, bb)
hmcols
#[1] "#0000BF" "#0055FF" "#00AAFF" "#00FFFF" "#55FFAA" "#AAFF55" "#FFFF00"
#[8] "#FFAA00" "#FF5500" "#BF0000"
#color.rs=rainbow(60)

posX=barplot(rep(1,length(hmcols)), col=hmcols, border = NA, space=0.1)
text(posX, -0.05, labels=hmcols,
     #col=hmcols,
     xpd=TRUE, #允许绘制在绘图区外
     cex=0.6, #字体是默认的倍数
     adj=1, #adj=1右上对齐
     srt=40) #倾斜30度)</div>
</div>
<br>




<a name='2_4'></a>
<h3 class="tutheader">连续型变量和渐变色的映射: cut()函数</h3>
<p>连续型变量怎么和渐变色一一对应呢？</p> 
<p>本例使用cut函数，实现了Y轴数字到渐变色的映射。</p> 
<p></p>
<img src="images/color/color_a4.png" /><br>


<div class="code notranslate maxHeight">
	<div style="white-space: pre-wrap;"># cut函数: 把数值型转为因子型
#cut(x, breaks): Convert Numeric to Factor

# 1. 生成数据
set.seed(20211119)
dat_1=rnorm(100, 0, 1)

# 测试 cut 函数
total_bins=10 #定义渐变色的阶梯数，也是数据划分的组数
dat_2=cut(dat_1, breaks=total_bins) #可以传入整数，表示分成几份；或者传入截断点数组
#table(dat_2) #total_bins=5时的结果
# (-1.87,-0.935] (-0.935,-0.0025]   (-0.0025,0.93]      (0.93,1.86]       (1.86,2.8] 
#       18               26               37               15                4 

# 2. 定义渐变色: 或 c('green4',"green1", "white",'maroon1', "maroon3")
colors2=colorRampPalette( 
  colors = c('green4', "white", "maroon3"), 
  interpolate ="spline") ( length(table(dat_2)) )
# 预览颜色(optional)
barplot(rep(1, length(colors2)), col=colors2, yaxt="n", space=0, border = NA)

# 3. 连续型变量dat和颜色colors2的映射
plotcol = colors2[ dat_2 ]; plotcol[1:5]

# 4. 画图
plot(dat_1, pch=20, mgp=c(2,0.5,0),
     col=plotcol, cex=0.5,
     bty="l", ylab="XX value")</div>
</div>









<br>











<a name='3'></a>
<h2 class="tutheader">ggplot2 中的色彩函数</h2>
<p><a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/">Colors_(ggplot2)</a></p>
coding ...





















<a name='100'></a>
<h2 class="tutheader">色彩进阶参考</h2>
<p><a target="_blank" href="https://www.canva.com/learn/100-color-combinations/">100 color combinations and how to apply them to your designs</a></p>

<p><a target="_blank" href="https://www.canva.com/colors/color-wheel/">Color Wheel</a>: Want to know what colors look good together? Canva's Color Wheel makes color combinations easy.</p>
<p><a target="_blank" href="https://www.canva.com/colors/color-palette-generator/">Color Palette Generator</a> </p>
<p><a target="_blank" href="https://www.canva.com/colors/color-palettes/">Color Palette Ideas </a> </p>

<pre>
最佳多色(n>10)配色程序: https://medialab.github.io/iwanthue/


更多配色方案
1. 花瓣网（https://huaban.com/）搜索「色卡」，查找别人上传的各种配色方案的卡片。
	很多色板Trending color palettes https://coolors.co/palettes/trending
2. Curated color palette inspiration. https://www.webdesignrankings.com/resources/lolcolors/
3. https://colorhunt.co/
4. https://vanschneider.com/colors
5. https://www.canva.com/learn/100-color-combinations/
6. https://color.adobe.com/zh/create/color-wheel
	https://www.sessions.edu/color-calculator/
	https://colorbrewer2.org/#type=sequential&scheme=BuGn&n=3

7. 如何创建和谐的颜色
https://www.sensationalcolor.com/creating-color-harmony/

8. D3 demo 用到的颜色 https://github.com/d3/d3/wiki/Gallery


9. 对图片的颜色进行聚类 http://www.cssdrive.com/imagepalette/

10.R中的颜色 https://qinqianshan.com/r_code/r_draw/colors-in-r/

11. 色盲色 
How to make figures and presentations that are friendly to Colorblind people: https://jfly.uni-koeln.de/color/

http://color.biaozhiku.com/

</pre>

















			</div>
		</div>
		
		<div class="previous-next-links">
			<div class="previous-design-link"><i style="font-size:16px;" class="fa fa-arrow-left" aria-hidden="true"></i> <a href="/R/R-intro.html" rel="pre">R 简介</a> </div>
			<div class="next-design-link"><a href="/R/R-intro.html" rel="next"> R 简介</a> <i style="font-size:16px;" class="fa fa-arrow-right" aria-hidden="true"></i></div>
		</div>
	</div>
</div>







	
	
	
	
	










</div>

</div>

</body>
</html>